import{r as s,j as e,i as C,U as S}from"./index-DfFjzv6a.js";import{a as M,N as A,G as E,V as q,M as T}from"./MainLayout-CaKANKVD.js";import{u as z}from"./index.esm-BmI1xTpi.js";const U=({setIsEditPassword:r})=>{const[i,p]=s.useState(),[n,b]=s.useState(!1),[a,h]=s.useState(!1),{register:c,handleSubmit:d,setFocus:f,watch:l,formState:{errors:o,isSubmitting:v}}=z();s.useEffect(()=>{f("password")},[f]);const x=l("newPassword"),u=async t=>{const{password:m,newPassword:g}=t;await C.patch("users/change_password",{password:m,newPassword:g}).then(w=>{var k;p((k=w==null?void 0:w.data)==null?void 0:k.message),setTimeout(()=>r(!1),3e3)}).catch(w=>{p(w.response.data.message)})};return e.jsxs("div",{className:"fixed left-1/3 top-1/3 z-20 mx-auto mt-10 w-[95%] sm:w-96 -translate-x-1/3 -translate-y-1/2 transform rounded-lg bg-white p-6 font-noto shadow-md sm:left-1/2 sm:-translate-x-1/2 md:left-[66%] xl:left-[57%]",children:[e.jsx("i",{className:"fa-solid fa-xmark-large absolute right-3 top-3 cursor-pointer",onClick:()=>r(!1),children:"X"}),e.jsx("h2",{className:"mb-6 text-center text-2xl font-semibold",children:"Thay đổi mật khẩu"}),e.jsxs("form",{onSubmit:d(u),className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{...c("password",{required:"Nhập mật khẩu của bạn",validate:t=>t.match(/^[A-Za-z0-9]+$/)?!0:"Vui lòng nhập mật khẩu của bạn"}),type:n?"text":"password",placeholder:"Mật khẩu",className:"mb-[0.5rem] w-full border border-inherit p-2 pl-3 font-noto outline-none"}),n?e.jsx("i",{className:"fa-solid fa-eye-slash absolute right-3 top-3 cursor-pointer",onClick:()=>b(!n)}):e.jsx("i",{className:"fa-solid fa-eye absolute right-3 top-3 cursor-pointer",onClick:()=>b(!n)}),e.jsx("br",{}),o.password&&e.jsx("p",{className:"mb-2 font-noto text-red-500",children:o.password.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{...c("newPassword",{required:"Nhập mật khẩu mới của bạn",minLength:{value:6,message:"Mật khẩu phải nhiều hơn 6 ký tự"},validate:t=>t.match(/^[A-Za-z0-9]+$/)?!0:"Mật khẩu chỉ bao gồm ký tự số và chữ"}),type:a?"text":"password",placeholder:"Mật khẩu mới",className:"mb-[0.5rem] w-full border border-inherit p-2 pl-3 font-noto outline-none"}),a?e.jsx("i",{className:"fa-solid fa-eye-slash absolute right-3 top-3 cursor-pointer",onClick:()=>h(!a)}):e.jsx("i",{className:"fa-solid fa-eye absolute right-3 top-3 cursor-pointer",onClick:()=>h(!a)}),e.jsx("br",{}),o.newPassword&&e.jsx("p",{className:"mb-2 font-noto text-red-500",children:o.newPassword.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{...c("confirmPassword",{required:"Xác nhận lại mật khẩu mới của bạn",validate:t=>t===x||"Xác nhận mật khẩu không đúng"}),name:"confirmPassword",type:a?"text":"password",placeholder:"Xác nhận mật khẩu mới",className:"mb-[0.5rem] w-full border border-inherit p-2 pl-3 font-noto outline-none"}),a?e.jsx("i",{className:"fa-solid fa-eye-slash absolute right-3 top-3 cursor-pointer",onClick:()=>h(!a)}):e.jsx("i",{className:"fa-solid fa-eye absolute right-3 top-3 cursor-pointer",onClick:()=>h(!a)}),e.jsx("br",{}),o.confirmPassword&&e.jsx("p",{className:"mb-2 font-noto text-red-500",children:o.confirmPassword.message})]}),e.jsx("button",{type:"submit",className:"w-full rounded-md bg-gradient-to-r from-pink-400 to-blue-600 py-2 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500",children:v?"Đang lưu...":"Lưu mật khẩu"}),e.jsx("p",{className:"text-center font-noto text-lg text-red-500",children:i})]})]})},D=({setIsEditProfile:r})=>{const{profile:i,setProfile:p}=s.useContext(S),[n,b]=s.useState(i==null?void 0:i.fullName),[a,h]=s.useState(i==null?void 0:i.sex),[c,d]=s.useState(!1),[f,l]=s.useState(),o=["0","1"],v=async u=>{if(u.preventDefault(),!n){l("Vui lòng nhập tên của bạn");return}if(n.length>30){l("Không nhập tên dài quá 30 ký tự");return}c||(d(!0),await C.patch("users/update_information",{fullName:n,sex:a}).then(t=>{var m;l((m=t==null?void 0:t.data)==null?void 0:m.message),d(!1),p(g=>({...g,fullName:n,sex:a})),setTimeout(()=>r(!1),1e3)}).catch(t=>{var m;d(!1),l((m=t==null?void 0:t.response)==null?void 0:m.message)}))},x=u=>{switch(u){case 0:return"Nữ";case 1:return"Nam";default:return}};return e.jsxs("div",{className:"fixed left-1/3 top-1/3 z-20 mx-auto mt-10 w-[95%] -translate-x-1/3 -translate-y-1/2 transform rounded-lg bg-white p-6 font-noto shadow-md sm:left-1/2 sm:w-96 sm:-translate-x-1/2 md:left-[66%] xl:left-[57%]",children:[e.jsx("i",{className:"fa-solid fa-xmark-large absolute right-3 top-3 cursor-pointer",onClick:()=>r(!1),children:"X"}),e.jsx("h2",{className:"mb-6 text-center text-2xl font-semibold",children:"Chỉnh sửa thông tin"}),e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",htmlFor:"currentPassword",children:"Họ và tên"}),e.jsx("input",{id:"fullName",value:n,onChange:u=>b(u.target.value),className:"mt-1 w-full rounded-md border border-gray-300 p-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Giới tính"}),e.jsx(M,{value:x(a),onChange:h,children:e.jsxs("div",{className:"relative mt-2",children:[e.jsx(A,{className:"relative w-full cursor-default rounded-md bg-white py-2 pl-3 pr-10 text-left text-gray-900 shadow-md",children:x(a)}),e.jsx(E,{transition:!0,className:"absolute z-10 mt-1 max-h-56 w-auto overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black/5 focus:outline-none data-[closed]:data-[leave]:opacity-0 data-[leave]:transition data-[leave]:duration-100 data-[leave]:ease-in sm:text-sm",children:o&&o.map((u,t)=>e.jsx(q,{value:t,className:"group relative w-32 cursor-default select-none py-2 pl-1 pr-1 text-gray-900 data-[focus]:bg-indigo-600 data-[focus]:text-white",children:x(t)},t))})]})})]}),e.jsx("button",{onClick:v,className:"w-full rounded-md bg-gradient-to-r from-pink-400 to-blue-600 py-2 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500",children:c?"Đang lưu...":"Lưu thông tin"}),e.jsx("p",{className:"text-center font-noto text-lg text-red-500",children:f})]})]})},G=()=>{const{profile:r,setProfile:i}=s.useContext(S),[p,n]=s.useState(!1),[b,a]=s.useState(!1),[h,c]=s.useState("Lưu ảnh"),[d,f]=s.useState(!1),[l,o]=s.useState(!1),[v,x]=s.useState(!1),[u,t]=s.useState(!1),[m,g]=s.useState(0),w=y=>{if(y.target.files.length>0){const N=y.target.files[0];let j=URL.createObjectURL(N);a(N),f(j)}},k=async y=>{if(m===1)return;if(g(1),!d){g(0);return}y.preventDefault();const N=new FormData;N.append("file",b),c("Đang lưu"),await C.patch("users/avatar",N,{headers:{"Content-Type":"multipart/form-data"}}).then(j=>{i(L=>({...L,avatar:j.data.avatar})),c("Lưu ảnh"),f(!1),t(j.data.message),setTimeout(()=>t(""),3e3),g(0),o(!1)}).catch(j=>{g(0),c("Lưu ảnh"),t(j.response.data[0].message)})},P=()=>{f(!1),o(!1)};return e.jsxs(T,{children:[!!r&&e.jsxs("div",{className:"absolute mt-[5rem] pb-[5rem] md:left-[5.5rem] md:w-[75vw] lg:left-[17rem] lg:w-[69vw] w-full rounded-lg bg-white shadow-lg",children:[e.jsxs("div",{className:"relative w-full flex justify-center",children:[e.jsx("img",{src:d||(r.avatar?r.avatar:"/images/logo/person-default.png"),alt:"User Avatar",className:"h-96 md:h-[60vh] w-full sm:w-3/4 lg:w-[60%] xl:w-[45%] rounded-lg object-cover lazyload"}),l?e.jsxs("ul",{className:"flex absolute bottom-1 right-4 ",children:[e.jsx("button",{onClick:P,className:"flex transform rounded-full bg-gradient-to-r from-pink-400 to-blue-600 px-4 py-2 text-white shadow-lg transition-all duration-300 hover:scale-105 hover:bg-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-300 active:scale-95",children:e.jsx("span",{className:"font-noto text-sm",children:"Dừng thay đổi"})}),e.jsx("button",{onClick:k,className:"transform rounded-full bg-gradient-to-r from-pink-400 to-blue-600 px-4 py-2 text-white shadow-lg transition-all duration-300 hover:scale-105 hover:bg-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-300 active:scale-95",children:e.jsxs("span",{className:"flex items-center justify-center space-x-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${l?"rotate-180":"rotate-0"} transition-transform duration-300`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})}),e.jsx("span",{className:"font-noto text-sm",children:h})]})})]}):e.jsx("button",{onClick:()=>o(!0),className:"absolute bottom-1 right-4 transform rounded-full bg-gradient-to-r from-pink-400 to-blue-600 px-4 py-2 text-white shadow-lg transition-all duration-300 hover:scale-105 hover:bg-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-300 active:scale-95",children:e.jsxs("span",{className:"flex items-center justify-center space-x-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${l?"rotate-180":"rotate-0"} transition-transform duration-300`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})}),e.jsx("span",{className:"font-noto text-sm",children:"Chỉnh sửa ảnh"})]})})]}),l&&e.jsx("div",{className:"flex justify-center",children:e.jsx("input",{type:"file",accept:"image/*",onChange:w,className:"mt-2 rounded-lg border p-2"})}),e.jsx("p",{className:"w-full text-center text-2xl text-red-600 px-2 mt-1 text-wrap",children:u}),e.jsxs("div",{className:"ml-3 mt-3 md:ml-0 md:text-center",children:[e.jsxs("h2",{className:"font-noto text-xl lg:text-2xl",children:["Tên: ",r.fullName]}),e.jsxs("p",{className:"mt-2 font-noto text-xl lg:text-2xl",children:["Email: ",r.email]}),e.jsxs("p",{className:"mt-2 font-noto text-xl lg:text-2xl",children:["Giới tính: ",r.sex===0?"Nữ":"Nam"]})]}),e.jsxs("div",{className:"mt-6 mx-2 flex flex-col justify-center md:flex-row",children:[e.jsx("div",{onClick:()=>n(!p),className:"transform cursor-pointer rounded-lg bg-gradient-to-r from-pink-400 to-blue-600 px-6 py-3 font-noto text-lg text-white shadow-lg transition-transform duration-300  hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 active:scale-95",children:"Chỉnh sửa thông tin"}),e.jsx("div",{onClick:()=>x(!v),className:"mt-2 transform cursor-pointer rounded-lg bg-gradient-to-r from-pink-400 to-blue-600 px-6 py-3 font-noto text-lg text-white shadow-lg transition-transform duration-300  hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 active:scale-95 md:ml-2 md:mt-0",children:"Thay đổi mật khẩu"})]})]}),v&&e.jsx(U,{setIsEditPassword:x}),p&&e.jsx(D,{setIsEditProfile:n})]})};export{G as default};
