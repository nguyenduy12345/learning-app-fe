import{r as l,U as H,j as e,i as C,b as ce}from"./index-DfFjzv6a.js";const ie=({question:t,lessonId:P,handleNextQuestion:R,setQuestionsCorrect:M})=>{const{setProfile:x,lessonsOfSummaryLesson:b,setLessonOfSummaryLesson:F}=l.useContext(H),[a,_]=l.useState(),[n,f]=l.useState(),[m,O]=l.useState([]),[D,p]=l.useState(0),[N,k]=l.useState("");l.useEffect(()=>{const h=t==null?void 0:t.answers.map(j=>({answer:j,selected:!1}));O(h)},[t]);const c=h=>{switch(h){case 0:return"A.";case 1:return"B.";case 2:return"C.";default:return"D."}},z=h=>{m.map(j=>j.selected=!1),m[h].selected=!0,O([...m]),f(h+1)},g=()=>{const h=t==null?void 0:t.answers.map(j=>({answer:j,selected:!1}));O(h),_(void 0),f(void 0),p(0)},Q=async()=>{if(D!==1){if(p(1),!n){k("Bạn chưa chọn đáp án!"),setTimeout(()=>k(""),1500),p(0);return}try{if((await C.post(`questions/${t._id}`,{answer:n-1})).data.data.correct){p(0),M(j=>j+1),_(!0);return}else{M(0),_(!1),await C.patch("users/update_asset",{hearts:Math.random()}),x(W=>({...W,hearts:W.hearts-1}));const j=b.findIndex(W=>W.lesson._id.toString()===P);if(j>-1){if(b[j].wrongQuestions.findIndex(E=>E.toString()===t._id.toString())>-1){p(0);return}await C.patch("summary_lesson/update_lesson",{lessonId:P,questionId:t._id}),b[j].wrongQuestions.push(t._id.toString()),F([...b]),p(0);return}return}}catch{p(0)}}},u=()=>{a&&(R(),_(void 0),f(void 0),p(0))};return e.jsx(e.Fragment,{children:t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mx-auto mb-2 mt-3 h-full w-full px-5 md:mt-7 md:w-[65%] md:px-0",children:[e.jsx("p",{className:"mb-2 text-center font-noto font-bold md:text-2xl",children:"Chọn đáp án đúng"}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex",children:[e.jsx("img",{src:"/images/meo_image_learning.png",alt:"",className:"lazyload mr-2 h-10 w-10 md:mr-5 md:h-24 md:w-24"}),e.jsx("p",{className:"flex items-end font-noto md:text-xl",children:t==null?void 0:t.question})]}),e.jsx("div",{className:"mt-2 flex w-full items-center justify-center",children:e.jsx("ul",{className:"mt-4 grid w-[80%] grid-cols-1 gap-4 sm:grid-cols-2 md:mt-6 md:w-full",children:m&&m.map((h,j)=>e.jsxs("li",{onClick:()=>z(j),className:`border-1 cursor-pointer rounded-lg py-4 pl-2 pr-8 font-medium ${h.selected?"bg-[#d7ffb8]":"bg-[#eeeeee]"} px-2 hover:bg-[#d7ffb8] md:text-xl`,children:[e.jsx("span",{className:"pl-3 font-noto font-medium",children:c(j)}),e.jsx("span",{className:"font-noto",children:h.answer})]},j))})})]})]}),e.jsxs("div",{className:`fixed bottom-0 h-[10rem] w-full lg:h-[13rem] ${a===!0?"bg-[#d7ffb8]":a===!1?"bg-[#ffdfe0]":"bg-[#ffffff]"} border-t-2 border-t-[#e5e5e5] px-3 py-2 md:mt-6 md:px-0 md:py-3`,children:[e.jsxs("div",{className:"relative mx-auto flex w-full justify-between md:w-[65%]",children:[e.jsx("div",{className:"cursor-pointer",children:a===!0||a===!1?"":e.jsx("button",{onClick:g,className:"borer-[#e5e5e5] flex transform items-center justify-center rounded-xl border-[3px] border-b-[5px] bg-white px-6 py-2 font-noto font-medium text-[#afafaf] transition-all duration-300 hover:scale-105 active:scale-95 md:px-10 md:py-3 md:text-xl md:font-bold",children:"Làm lại"})}),e.jsx("div",{className:"cursor-pointer",children:a===!0?e.jsx("button",{onClick:u,className:"flex transform cursor-pointer items-center justify-center rounded-lg bg-[#58cc02] px-6 py-2 font-noto font-medium text-white transition-all duration-300 hover:scale-105 active:scale-95 md:px-6 md:py-3 md:text-lg md:font-bold",children:"Câu tiếp theo"}):a===!1?e.jsx("button",{onClick:g,className:"borer-[#e5e5e5] flex transform cursor-pointer items-center justify-center rounded-xl border-[1px] border-b-[5px] bg-[#58cc02] px-6 py-2 font-noto font-medium text-white transition-all duration-300 hover:scale-105 active:scale-95 md:px-6 md:py-3 md:text-lg md:font-bold",children:"Làm lại"}):e.jsx("button",{onClick:Q,className:`flex transform cursor-pointer items-center justify-center rounded-lg ${n?"bg-[#58cc02] text-white":"bg-[#e5e5e5] text-[#afafaf]"} px-6 py-2 font-noto font-medium transition-all duration-300 hover:scale-105 active:scale-95 md:px-6 md:py-3 md:text-lg md:font-bold`,children:"Kiểm tra đáp án"})}),a===!0?e.jsxs("div",{className:"absolute left-2 top-[2.1rem] text-4xl font-bold text-green-600 md:left-2 md:text-6xl",children:[e.jsx("p",{className:"max-w-fit",children:"Good!"}),e.jsx("p",{className:"text-xl",children:"Cùng tới với câu tiếp theo nào!"})]}):a===!1?e.jsxs("div",{className:"absolute left-2 top-[2.1rem] text-4xl font-bold text-red-600 md:left-2 md:text-6xl",children:[e.jsx("p",{className:"max-w-fit",children:"Sai!"}),e.jsx("p",{className:"text-xl",children:"Bạn làm sai rồi, làm lại nhé!"})]}):""]}),e.jsx("p",{className:"mt-3 w-full text-center font-noto text-lg font-semibold text-red-500 md:text-xl",children:N})]})]})})},me=({question:t,lessonId:P,handleNextQuestion:R,setQuestionsCorrect:M})=>{var L;const{setProfile:x,lessonsOfSummaryLesson:b,setLessonOfSummaryLesson:F}=l.useContext(H),[a,_]=l.useState([]),[n,f]=l.useState([]),[m,O]=l.useState(),[D,p]=l.useState(""),[N,k]=l.useState(0),[c,z]=l.useState([]),[g,Q]=l.useState([]),[u,h]=l.useState(0);l.useEffect(()=>{const r=[];for(let d=0;d<=c.length/2+2;d+=2)r.push({left:c[d],right:c[d+1]});Q(r)},[c]);function j(r){for(let d=r.length-1;d>0;d--){const w=Math.floor(Math.random()*(d+1));[r[d],r[w]]=[r[w],r[d]]}return r}l.useEffect(()=>{var w,$;const r=(w=t==null?void 0:t.rightOptions)==null?void 0:w.map(B=>({right:B,selected:!1})),d=($=t==null?void 0:t.leftOptions)==null?void 0:$.map(B=>({left:B,selected:!1}));f(j(r)),_(d)},[t]);const W=(r,d)=>{a[d].selected!==!0&&u===0&&(h(1),a[d].selected=!0,_([...a]),z([...c,r]))},E=(r,d)=>{n[d].selected!==!0&&u===1&&(h(0),n[d].selected=!0,f([...n]),z([...c,r]))},U=async()=>{if(N!==1){if(k(1),g.length!==(t==null?void 0:t.leftOptions.length)){k(0),p("Hãy nối tất cả các từ đã cho bên dưới"),setTimeout(()=>p(""),1500);return}try{if((await C.post(`questions/${t._id}`,{answer:g})).data.data.correct){O(!0),M(d=>d+1),k(0);return}else{O(!1),M(0),await C.patch("users/update_asset",{hearts:Math.random()}),x(w=>({...w,hearts:w.hearts-1}));const d=b.findIndex(w=>w.lesson._id.toString()===P);if(d>-1){if(b[d].wrongQuestions.findIndex($=>$.toString()===t._id.toString())>-1){k(0);return}await C.patch("summary_lesson/update_lesson",{lessonId:P,questionId:t._id}),b[d].wrongQuestions.push(t._id.toString()),F([...b]),k(0);return}return}}catch{k(0)}}},A=()=>{const r=t==null?void 0:t.rightOptions.map(w=>({right:w,selected:!1})),d=t==null?void 0:t.leftOptions.map(w=>({left:w,selected:!1}));h(0),f(j(r)),_(d),z([]),Q([]),k(0),O(void 0)},G=()=>{if(m){k(0),R(),z([]),Q([]),O(void 0);return}};return e.jsx(e.Fragment,{children:t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mx-auto mt-[2rem] w-full px-5 md:w-[65%] md:px-0",children:[e.jsx("p",{className:"text-md text-center font-noto font-bold lg:text-lg",children:"Nối các từ từ bên cột trái với các từ tại cột phải sao cho đúng"}),e.jsxs("div",{className:"flex w-full justify-between",children:[e.jsx("ul",{className:"mt-4 grid w-[44%] grid-cols-1 gap-2 md:mt-6 md:w-[33%]",children:a&&(a==null?void 0:a.map((r,d)=>e.jsxs("li",{onClick:()=>W(r==null?void 0:r.left,d),className:"border-1 text-md relative flex h-[2.5rem] w-full cursor-pointer items-center justify-center rounded-xl border-[2px] border-b-[4px] border-[#e5e5e5] p-1 font-noto hover:bg-green-200 active:scale-95 md:text-lg lg:h-[3rem]",children:[e.jsx("div",{className:"absolute left-[0.5rem] flex h-[2rem] w-[2rem] items-center justify-center rounded-full border-[2px] border-[#e5e5e5] text-[#afafaf] sm:left-[1rem]",children:d+1}),r!=null&&r.selected?"":r==null?void 0:r.left]},d)))}),e.jsx("ul",{className:"mt-4 grid w-[44%] grid-cols-1 gap-2 md:mt-6 md:w-[33%]",children:n&&(n==null?void 0:n.map((r,d)=>e.jsxs("li",{onClick:()=>E(r==null?void 0:r.right,d),className:"border-1 text-md relative flex h-[2.5rem] w-full cursor-pointer items-center justify-center rounded-xl border-[2px] border-b-[4px] border-[#e5e5e5] p-1 font-noto hover:bg-green-200 active:scale-95 md:text-lg lg:h-[3rem]",children:[e.jsx("div",{className:"absolute left-[0.5rem] flex h-[2rem] w-[2rem] items-center justify-center rounded-full border-[2px] border-[#e5e5e5] text-[#afafaf] sm:left-[1rem]",children:d+1}),r!=null&&r.selected?"":r==null?void 0:r.right]},d)))})]}),e.jsxs("h4",{className:"md:xl text-md md:text-md mb-2 mt-5 font-noto font-medium lg:mb-5 xl:text-lg",children:["Các từ đã nối:"," "]}),e.jsx("ul",{className:"flex flex-wrap justify-evenly gap-2",children:g&&g.map((r,d)=>e.jsxs("li",{className:"text-md flex rounded-xl border-[2px] border-b-[4px] border-[#e5e5e5] bg-white px-4 font-noto lg:px-6 lg:py-1",children:[e.jsx("p",{children:`${r.left?r.left+"__":""}`}),e.jsxs("p",{children:[" ",r.right?r.right:""]})]},d))})]}),e.jsxs("div",{className:`fixed bottom-0 h-[10rem] w-full ${m===!0?"bg-[#d7ffb8]":m===!1?"bg-[#ffdfe0]":"bg-[#ffffff]"} border-t-2 border-t-[#e5e5e5] px-3 py-2 md:mt-6 md:px-0 md:py-3`,children:[e.jsxs("div",{className:"relative mx-auto flex w-full justify-between md:w-[65%]",children:[e.jsx("div",{className:"cursor-pointer",children:m===!0||m===!1?"":e.jsx("button",{onClick:A,className:"borer-[#e5e5e5] flex transform items-center justify-center rounded-xl border-[3px] border-b-[5px] bg-white px-6 py-2 font-noto font-medium text-[#afafaf] transition-all duration-300 hover:scale-105 active:scale-95 md:px-10 md:py-3 md:text-xl md:font-bold",children:"Làm lại"})}),e.jsx("div",{className:"cursor-pointer",children:m===!0?e.jsx("button",{onClick:G,className:"flex transform cursor-pointer items-center justify-center rounded-lg bg-[#58cc02] px-6 py-2 font-noto font-medium text-white transition-all duration-300 hover:scale-105 active:scale-95 md:px-6 md:py-3 md:text-lg md:font-bold",children:"Câu tiếp theo"}):m===!1?e.jsx("button",{onClick:A,className:"borer-[#e5e5e5] flex transform cursor-pointer items-center justify-center rounded-xl border-[1px] border-b-[5px] bg-[#58cc02] px-6 py-2 font-noto font-medium text-white transition-all duration-300 hover:scale-105 active:scale-95 md:px-6 md:py-3 md:text-lg md:font-bold",children:"Làm lại"}):e.jsx("button",{onClick:U,className:`flex transform cursor-pointer items-center justify-center rounded-lg ${g.length===((L=t==null?void 0:t.leftOptions)==null?void 0:L.length)?"bg-[#58cc02] text-white":"bg-[#e5e5e5] text-[#afafaf]"} px-6 py-2 font-noto font-medium transition-all duration-300 hover:scale-105 active:scale-95 md:px-6 md:py-3 md:text-lg md:font-bold`,children:"Kiểm tra đáp án"})}),m===!0?e.jsxs("div",{className:"absolute left-2 top-[2.1rem] text-4xl font-bold text-green-600 md:left-2 md:text-6xl",children:[e.jsx("p",{children:"Good!"}),e.jsx("p",{className:"text-xl",children:"Cùng tới với câu tiếp theo nào!"})]}):m===!1?e.jsxs("div",{className:"absolute left-2 top-[2.1rem] text-4xl font-bold text-red-600 md:left-2 md:text-6xl",children:[e.jsx("p",{children:"Sai!"}),e.jsx("p",{className:"text-xl",children:"Bạn làm sai rồi, làm lại nhé!"})]}):""]}),e.jsx("p",{className:"mt-3 w-full text-center font-noto text-lg font-semibold text-red-500 md:text-xl",children:D})]})]})})},xe=({question:t,lessonId:P,handleNextQuestion:R,setQuestionsCorrect:M})=>{const{setProfile:x,lessonsOfSummaryLesson:b,setLessonOfSummaryLesson:F}=l.useContext(H),[a,_]=l.useState((t==null?void 0:t.document)||""),[n,f]=l.useState((t==null?void 0:t.words)||[]),[m,O]=l.useState(!1),[D,p]=l.useState([]),[N,k]=l.useState(void 0),[c,z]=l.useState(""),[g,Q]=l.useState(0),u=l.useRef(),h=L=>{L.preventDefault()},j=(L,r)=>{r.target.innerHTML=n[m];const d=[...n];d.splice(m,1),f(d),O(!1);const w=D.findIndex($=>+$.index==+L);if(w>-1){const $=[...n];$.splice(m,1),$.splice(m,0,D[w].word),f($),D[w].word=n[m],p([...D])}else p([...D,{index:L,word:n[m]}])},W=(L,r)=>{O(r)},E=L=>{const r=L.split("__________");return r.map((d,w)=>w<r.length-1?e.jsxs(e.Fragment,{children:[d,e.jsx("div",{onDragOver:h,onDrop:$=>j(w,$),style:{userSelect:"none"},className:"m-1 inline-block h-6 w-24 rounded-sm bg-gray-300 text-center normal-case md:h-7 md:w-28"},w)]}):d)},U=async()=>{if(g!==1){if(Q(1),D.length!==+(t==null?void 0:t.countCorrect)){Q(0),z("Hãy điền đủ vị trí trống trong đoạn văn!"),setTimeout(()=>z(""),1500);return}try{if((await C.post(`questions/${t._id}`,{answer:D})).data.data.correct){M(r=>r+1),k(!0),Q(0);return}else{M(0),k(!1),await C.patch("users/update_asset",{hearts:Math.random()}),x(d=>({...d,hearts:d.hearts-1}));const r=b.findIndex(d=>d.lesson._id.toString()===P);if(r>-1){if(b[r].wrongQuestions.findIndex(w=>w.toString()===t._id.toString())>-1){Q(0);return}await C.patch("summary_lesson/update_lesson",{lessonId:P,questionId:t._id}),b[r].wrongQuestions.push(t._id.toString()),F([...b]),Q(0);return}return}}catch{Q(0)}}},A=()=>{if(Q(0),f(t==null?void 0:t.words),p([]),k(void 0),O(!1),u.current){const L=u.current.children;for(let r of L)r.innerHTML="&nbsp;"}};l.useEffect(()=>{if(_(t==null?void 0:t.document),f(t==null?void 0:t.words),p([]),k(void 0),O(!1),u.current){const L=u.current.children;for(let r of L)r.innerHTML="&nbsp;"}},[t]);const G=()=>{if(N){R(),k(void 0),Q(0);return}};return e.jsx(e.Fragment,{children:t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mx-auto mt-3 w-full px-5 md:mb-8 md:mt-7 md:w-[75%] md:px-0",children:[e.jsx("p",{className:"text-md text-center font-noto font-medium md:mb-4 lg:text-lg",children:"Di chuyển các từ bên dưới để ghép vào chỗ trống của đoạn văn bên dưới sao cho đúng:"}),e.jsxs("div",{className:"mt-2 md:mt-6",children:[e.jsxs("div",{className:"flex",children:[e.jsx("img",{src:"/images/meo_image_learning.png",alt:"",className:"lazyload mr-2 h-10 w-10 md:mr-5 md:h-24 md:w-24"}),e.jsx("div",{ref:u,className:"text-md inline-block w-full items-end font-noto lg:text-lg",children:E(a)})]}),e.jsx("div",{className:"mt-4 flex w-full items-center justify-center lg:mt-6",children:e.jsx("ul",{className:"flex w-full flex-wrap justify-evenly gap-1 md:gap-4 lg:mt-4 lg:w-5/6",children:n.map((L,r)=>e.jsx("li",{draggable:"true",onDragStart:()=>W(L,r),className:"border-1 cursor-pointer rounded-lg bg-[#eeeeee] px-6 py-1 text-sm lowercase hover:bg-green-400 md:px-8 lg:text-lg",children:L},r))})})]})]}),e.jsxs("div",{className:`fixed bottom-0 h-52 w-full ${N===!0?"bg-[#d7ffb8]":N===!1?"bg-[#ffdfe0]":"bg-[#ffffff]"} border-t-2 border-t-[#e5e5e5] px-3 py-2 md:mt-6 md:px-0 md:py-3`,children:[e.jsxs("div",{className:"relative mx-auto flex w-full justify-between md:w-[65%]",children:[e.jsx("div",{className:"cursor-pointer",children:N===!0||N===!1?"":e.jsx("button",{onClick:A,className:"flex transform items-center justify-center rounded-xl border-[3px] border-b-[5px] border-[#e5e5e5] bg-white px-6 py-2 font-noto font-medium text-[#afafaf] transition-all duration-300 hover:scale-105 active:scale-95 md:px-10 md:py-3 md:text-xl md:font-bold",children:"Làm lại"})}),e.jsx("div",{className:"cursor-pointer",children:N===!0?e.jsx("button",{onClick:G,className:"flex transform cursor-pointer items-center justify-center rounded-lg bg-[#58cc02] px-6 py-2 font-noto font-medium text-white transition-all duration-300 hover:scale-105 active:scale-95 md:px-6 md:py-3 md:text-lg md:font-bold",children:"Câu tiếp theo"}):N===!1?e.jsx("button",{onClick:A,className:"borer-[#e5e5e5] flex transform cursor-pointer items-center justify-center rounded-xl border-[1px] border-b-[5px] bg-[#58cc02] px-6 py-2 font-noto font-medium text-white transition-all duration-300 hover:scale-105 active:scale-95 md:px-6 md:py-3 md:text-lg md:font-bold",children:"Làm lại"}):e.jsx("button",{onClick:U,className:`flex transform cursor-pointer items-center justify-center rounded-lg ${D.length===+(t==null?void 0:t.countCorrect)?"bg-[#58cc02] text-white":"bg-[#e5e5e5] text-[#afafaf]"} px-6 py-2 font-noto font-medium transition-all duration-300 hover:scale-105 active:scale-95 md:px-6 md:py-3 md:text-lg md:font-bold`,children:"Kiểm tra đáp án"})}),N===!0?e.jsxs("div",{className:"absolute left-2 top-[2.1rem] text-4xl font-bold text-green-600 md:left-2 md:text-6xl",children:[e.jsx("p",{children:"Good!"}),e.jsx("p",{className:"text-xl",children:"Cùng tới với câu tiếp theo nào!"})]}):N===!1?e.jsxs("div",{className:"absolute left-2 top-[2.1rem] text-4xl font-bold text-red-600 md:left-2 md:text-6xl",children:[e.jsx("p",{children:"Sai!"}),e.jsx("p",{className:"text-xl",children:"Bạn làm sai rồi, làm lại nhé!"})]}):""]}),e.jsx("p",{className:"mt-3 w-full text-center font-noto text-lg font-semibold text-red-500 md:text-xl",children:c})]})]})})},fe=({question:t,lessonId:P,handleNextQuestion:R,setQuestionsCorrect:M})=>{const{setProfile:x,lessonsOfSummaryLesson:b,setLessonOfSummaryLesson:F}=l.useContext(H),[a,_]=l.useState(),[n,f]=l.useState([]),[m,O]=l.useState([]),[D,p]=l.useState(0),[N,k]=l.useState("");l.useEffect(()=>{var h;const u=(h=t==null?void 0:t.words)==null?void 0:h.map(j=>({word:j,selected:!1}));O(u)},[t]);const c=(u,h)=>{u.selected||(m[h].selected=!0,O([...m]),f([...n,u.word]))},z=()=>{const u=t==null?void 0:t.words.map(h=>({word:h,selected:!1}));O(u),_(void 0),f([]),p(0)},g=async()=>{if(D===1)return;if(p(1),n.length===0){k("Hãy chọn từ để sắp xếp"),setTimeout(()=>k(""),1500),p(0);return}const u=n.join(" ");try{if((await C.post(`questions/${t._id}`,{answer:u})).data.data.correct){p(0),M(j=>j+1),_(!0);return}else{M(0),_(!1),await C.patch("users/update_asset",{hearts:Math.random()}),x(W=>({...W,hearts:W.hearts-1}));const j=b.findIndex(W=>W.lesson._id.toString()===P);if(j>-1){if(b[j].wrongQuestions.findIndex(E=>E.toString()===t._id.toString())>-1){p(0);return}await C.patch("summary_lesson/update_lesson",{lessonId:P,questionId:t._id}),b[j].wrongQuestions.push(t._id.toString()),F([...b]),p(0);return}return}}catch{p(0)}},Q=()=>{a&&(R(),_(void 0),f([]),p(0))};return e.jsx(e.Fragment,{children:t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mx-auto mb-2 mt-3 h-full w-full px-5 md:mt-7 md:w-[65%] md:px-0",children:[e.jsx("p",{className:"text-center font-noto font-bold md:text-xl",children:"Sắp xếp các từ bên dưới thành câu đúng nghĩa với câu đã cho:"}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex",children:[e.jsx("img",{src:"/images/logo/speaker.png",alt:"",className:"lazyload mr-2 h-10 w-10 md:mr-2 md:h-16 md:w-16"}),e.jsxs("p",{className:"flex items-end font-noto md:text-xl",children:[': " ',t==null?void 0:t.document,' "']})]}),e.jsx("div",{className:"mt-3 flex h-[6rem] w-full items-center justify-center gap-1 rounded-xl border-2 border-[#e5e5e5] px-4",children:e.jsx("div",{className:"text-md flex h-auto flex-wrap gap-2 border-b-[1px] border-[#9f8c8c] px-4 lg:text-lg",children:n&&(n==null?void 0:n.map((u,h)=>e.jsx("p",{children:u},h)))})}),e.jsx("div",{className:"mt-4 flex w-full items-center justify-center",children:e.jsx("ul",{className:"flex w-full flex-wrap justify-evenly gap-1 md:gap-2 lg:w-5/6",children:m==null?void 0:m.map((u,h)=>e.jsx("li",{onClick:()=>c(u,h),className:"border-1 text-md h-[2.5rem] cursor-pointer rounded-lg border-[2px] border-[#e5e5e5] px-6 py-1 lowercase hover:bg-green-400 lg:px-8 lg:text-lg",children:u.selected===!1&&u.word?u.word:" "},h))})})]})]}),e.jsxs("div",{className:`fixed bottom-0 h-[10rem] w-full ${a===!0?"bg-[#d7ffb8]":a===!1?"bg-[#ffdfe0]":"bg-[#ffffff]"} border-t-2 border-t-[#e5e5e5] px-3 py-2 md:mt-6 md:px-0 md:py-3`,children:[e.jsxs("div",{className:"relative mx-auto flex w-full justify-between md:w-[65%]",children:[e.jsx("div",{className:"cursor-pointer",children:a===!0||a===!1?"":e.jsx("button",{onClick:z,className:"borer-[#e5e5e5] flex transform items-center justify-center rounded-xl border-[3px] border-b-[5px] bg-white px-6 py-2 font-noto font-medium text-[#afafaf] transition-all duration-300 hover:scale-105 active:scale-95 md:px-10 md:py-3 md:text-xl md:font-bold",children:"Làm lại"})}),e.jsx("div",{className:"cursor-pointer",children:a===!0?e.jsx("button",{onClick:Q,className:"flex transform cursor-pointer items-center justify-center rounded-lg bg-[#58cc02] px-6 py-2 font-noto font-medium text-white transition-all duration-300 hover:scale-105 active:scale-95 md:px-6 md:py-3 md:text-lg md:font-bold",children:"Câu tiếp theo"}):a===!1?e.jsx("button",{onClick:z,className:"borer-[#e5e5e5] flex transform cursor-pointer items-center justify-center rounded-xl border-[1px] border-b-[5px] bg-[#58cc02] px-6 py-2 font-noto font-medium text-white transition-all duration-300 hover:scale-105 active:scale-95 md:px-6 md:py-3 md:text-lg md:font-bold",children:"Làm lại"}):e.jsx("button",{onClick:g,className:`flex transform cursor-pointer items-center justify-center rounded-lg ${n.length>0?"bg-[#58cc02] text-white":"bg-[#e5e5e5] text-[#afafaf]"} px-6 py-2 font-noto font-medium transition-all duration-300 hover:scale-105 active:scale-95 md:px-6 md:py-3 md:text-lg md:font-bold`,children:"Kiểm tra đáp án"})}),a===!0?e.jsxs("div",{className:"absolute left-2 top-[2.1rem] text-4xl font-bold text-green-600 md:left-2 md:text-6xl",children:[e.jsx("p",{children:"Good!"}),e.jsx("p",{className:"text-sm md:text-xl",children:"Cùng tới với câu tiếp theo nào!"})]}):a===!1?e.jsxs("div",{className:"top-[2.1rem]text-4xl absolute left-2 font-bold text-red-600 md:left-2 md:text-6xl",children:[e.jsx("p",{children:"Sai!"}),e.jsx("p",{className:"text-sm md:text-xl",children:"Bạn làm sai rồi, làm lại nhé!"})]}):""]}),e.jsx("p",{className:"mt-3 w-full text-center font-noto text-lg font-semibold text-red-500 md:text-xl",children:N})]})]})})},ue=({setIsCongratulation:t,currentLesson:P,lessons:R,setIsLesson:M})=>{const x=()=>{t(!1),M(!1)};return e.jsx("div",{className:"fixed z-30 mx-auto my-auto flex h-screen w-full items-center justify-center bg-[#e8e8e8]",children:e.jsxs("div",{className:"w-[95%] sm:w-[70%]",children:[e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsxs("div",{style:{clipPath:"polygon(0% 0%, 100% 0%, 100% 96%, 64% 96%, 51% 100%, 36% 96%, 0 95%)"},className:"ml-2 w-[70%] rounded-xl bg-white p-4 font-noto",children:[e.jsxs("ul",{className:"flex justify-center items-center text-center text-2xl font-bold",children:[e.jsx("li",{children:e.jsx("img",{src:"/images/congru.png",className:"w-12 h-12 lazyload"})}),e.jsx("li",{className:"ml-2",children:"CHÚC MỪNG"})]}),e.jsx("p",{className:"text-center",children:"Bạn vừa hoàn thành một bài học"}),e.jsx("p",{className:"text-center font-noto",children:"Bạn đã nhận được: "}),e.jsxs("ul",{className:"mx-auto mt-3 mb-3 flex w-[90%] sm:w-[60%] justify-around text-left text-xl font-bold",children:[e.jsxs("li",{className:"flex items-center",children:[R[P-1].gems,e.jsx("img",{src:"/images/logo/coins.png",className:"ml-1 h-4 lazyload"})]}),e.jsxs("li",{className:"flex items-center",children:[R[P-1].experiences,e.jsx("img",{src:"/images/logo/explogo.jfif",className:"ml-1 h-4 lazyload"})]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("span",{children:"5"}),e.jsx("img",{src:"/images/logo/heart.webp",className:"ml-1 h-4 lazyload"})]})]}),e.jsx("div",{onClick:()=>x(),className:"w-[9rem] text-center mx-auto mb-4 mt-5 cursor-pointer border-2 border-[#b7dceb] rounded-lg bg-[#d3e9f8] hover:text-white hover:border-[#dfe1e2] shadow-xl",children:"Tiếp tục"})]})}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("img",{src:"/images/cat_congru1.png",className:"h-[10rem] w-[10rem] lazyload"})})]})})},he=({listMisson:t,setListMisson:P,isShowInfoMisson:R,setIsShowInfoMisson:M})=>{const{setProfile:x}=l.useContext(H),[b,F]=l.useState([]);return l.useEffect(()=>{const a=t.length!==0&&t.reduce((_,n)=>(_.some(f=>f.missonId.type===n.missonId.type)||_.push(n),_),[]);F(a)},[t]),l.useEffect(()=>{(async()=>{const _=t.filter(n=>n.completed===!0&&n.missonId.type!=="questions");if(_.length!==0){const n=_.reduce((f,m)=>(m.completed&&(f.gems+=m.missonId.gems,f.experiences+=m.missonId.experiences,f.turns+=m.missonId.hearts),f),{gems:0,experiences:0,turns:0});await C.patch("users/update_asset",n).then(()=>{x(f=>{const m={...f};return m.experiences=+m.experiences+ +n.experiences,m.gems=+m.gems+ +n.gems,m.hearts=+m.hearts+ +n.turns,m})}).catch(f=>f)}})()},[t]),R&&t&&b.length!==0&&e.jsx("div",{className:"fixed z-30 mx-auto my-auto flex h-screen w-full items-center justify-center bg-[#e8e8e8]",children:e.jsx("div",{className:"w-[95%]",children:e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsxs("div",{className:"ml-2 w-[90%] rounded-xl bg-white p-4 font-noto md:w-[70%]",children:[e.jsx("p",{className:"md:text-md text-center text-xs font-semibold uppercase lg:text-lg",children:"Tiến trình hiện tại của các nhiệm vụ"}),e.jsx("ul",{className:"mt-4 max-h-[70vh] space-y-3 overflow-scroll scrollbar-none",children:b&&b.map((a,_)=>e.jsxs("li",{className:`w-full ${a.completed?"bg-[#ebf9e4] text-black":""} rounded-xl border-[1px] border-[#e5e5e5] p-4`,children:[e.jsxs("div",{className:"flex",children:[e.jsxs("ul",{className:"flex-grow items-start",children:[e.jsx("li",{className:"pl-2 tracking-wider",children:a.missonId.misson}),e.jsxs("li",{className:"relative ml-1 mt-2 h-6 w-full rounded-xl bg-[#e5e5e5]",children:[e.jsx("div",{style:{width:`${+a.currentProgress<=+a.missonId.numberOfRequirements?+a.currentProgress/+a.missonId.numberOfRequirements*100:100}%`},className:"absolute top-[1.3px] h-[1.3rem] rounded-xl bg-[#58cc02] transition-all duration-500 ease-linear"}),e.jsxs("p",{className:"absolute left-[40%] top-0 font-noto font-semibold text-white",children:[a.currentProgress," /"," ",a.missonId.numberOfRequirements]})]})]}),e.jsxs("div",{className:"relative ml-4 flex items-end justify-center",children:[e.jsx("img",{src:"/images/logo/misson-gift.svg",className:"lazyload h-9 w-9"}),a.completed&&e.jsx("i",{className:"fa-solid fa-check absolute right-[-0.7rem] top-[0.5rem] hidden text-[3.5rem] font-bold text-[#774e2f] md:flex"})]})]}),a.completed&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"mt-3 text-center font-noto text-black",children:["Bạn đã nhận được:"," "]}),e.jsxs("ul",{className:"mx-auto flex w-[90%] justify-around text-left text-xl font-bold sm:w-[60%]",children:[e.jsxs("li",{className:"flex items-center",children:[a.missonId.gems,e.jsx("img",{src:"/images/logo/coins.png",className:"lazyload ml-1 h-4"})]}),e.jsxs("li",{className:"flex items-center",children:[a.missonId.experiences,e.jsx("img",{src:"/images/logo/explogo.jfif",className:"lazyload ml-1 h-4"})]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("span",{children:a.missonId.hearts}),e.jsx("img",{src:"/images/logo/heart.webp",className:"lazyload ml-1 h-4"})]})]})]})]},_))}),e.jsx("div",{onClick:()=>{M(!1),P([])},className:"mx-auto mb-4 mt-5 w-[9rem] cursor-pointer rounded-lg border-2 border-[#b7dceb] bg-[#d3e9f8] text-center shadow-xl hover:border-[#dfe1e2] hover:text-white",children:"Đóng"})]})})})})},be=({courseId:t,sectionId:P,milestoneId:R,setIsLesson:M,lessons:x,currentLesson:b,setCurrentLesson:F})=>{var J,V,X,Y,Z,q,ee,te,se,re,ne,le,ae;const{profile:a,setProfile:_,missons:n,setMissons:f,setCourseOfLearningProcess:m,lessonsOfSummaryLesson:O,setLessonOfSummaryLesson:D}=l.useContext(H),{setIsLoading:p}=l.useContext(ce),[N,k]=l.useState(0),[c,z]=l.useState(b||1),[g,Q]=l.useState(x[c-1]&&((J=x[c-1])==null?void 0:J.questions)),[u,h]=l.useState(x[c-1]&&x[c-1]._id),j=l.useRef(null),[W,E]=l.useState(0),[U,A]=l.useState(!1),[G,L]=l.useState([]),[r,d]=l.useState(!1),[w,$]=l.useState(0);l.useEffect(()=>{x.length===0&&M(!1)},[x]),l.useEffect(()=>{(async()=>{var s,o,I;try{p(!0);const S=await C.get(`lessons/${x[c-1]._id}`,{onDownloadProgress:i=>{+Math.round(i.loaded*100/i.total)>=100&&p(!1)}});Q((I=(o=(s=S==null?void 0:S.data)==null?void 0:s.data)==null?void 0:o.lesson)==null?void 0:I.questions)}catch(S){return S}})(),h(x[c-1]&&x[c-1]._id)},[c,b]);const B=n.map((v,s)=>{if(v.completed===!1)return{index:s,misson:v}}).filter(v=>v!==void 0);let T=[...G];l.useEffect(()=>{B==null||B.map(async v=>{var s,o,I,S;if(((o=(s=v==null?void 0:v.misson)==null?void 0:s.missonId)==null?void 0:o.type)==="questions"&&+w==+((S=(I=v==null?void 0:v.misson)==null?void 0:I.missonId)==null?void 0:S.numberOfRequirements))try{await C.patch(`user_missons/update?missonId=${v.misson.missonId._id}`,{currentProgress:w,status:!0}),await C.patch("users/update_asset",{experiences:v.misson.missonId.experiences,gems:v.misson.missonId.gems,turns:v.misson.missonId.hearts}),f(i=>{const y=[...i];return y[v.index].currentProgress=w,y[v.index].completed=!0,y}),_(i=>{const y={...i};return y.experiences=+y.experiences+ +v.misson.missonId.experiences,y.gems=+y.gems+ +v.misson.missonId.gems,y.hearts=+y.hearts+ +v.misson.missonId.hearts,y}),L(i=>{let y=[...i];return(y==null?void 0:y.findIndex(oe=>oe.missonId._id.toString()===v.misson.milestoneId._id.toString()))>-1?y:y=[...i,v.misson]}),d(!0)}catch{}})},[w]);const K=l.useCallback(async()=>{if(W!==1){if(E(1),k(N+1),N+1>(g==null?void 0:g.length)-1)try{if(c+1>x.length){p(!0),await C.patch("learning_process/update_milestone",{courseId:t,sectionId:P,milestoneId:R,currentLesson:b,totalLessonDone:b,status:2}),await C.patch("learning_process/update_section",{courseId:t,sectionId:P,totalMilestoneDone:c}),await C.patch("users/update_asset",{experiences:+x[c-1].experiences,gems:+x[c-1].gems,turns:5,dayStreak:Math.random()}),_(s=>{const o={...s};return o.experiences=+o.experiences+ +x[c-1].experiences,o.gems=+o.gems+ +x[c-1].gems,o.hearts=+o.hearts+5,o});const v=B.map(async s=>{var o,I;switch((I=(o=s==null?void 0:s.misson)==null?void 0:o.missonId)==null?void 0:I.type){case"gems":await C.patch(`user_missons/update?missonId=${s.misson.missonId._id}`,{currentProgress:+x[c-1].gems,status:+n[s.index].currentProgress+ +x[c-1].gems>=+n[s.index].missonId.numberOfRequirements}),f(S=>{const i=[...S];return i[s.index].currentProgress=+i[s.index].currentProgress+ +x[c-1].gems,i[s.index].completed=+n[s.index].currentProgress>=+n[s.index].missonId.numberOfRequirements,i}),T=[...T,s.misson];break;case"experiences":await C.patch(`user_missons/update?missonId=${s.misson.missonId._id}`,{currentProgress:+x[c-1].experiences,status:+n[s.index].currentProgress+ +x[c-1].experiences>=+n[s.index].missonId.numberOfRequirements}),f(S=>{const i=[...S];return i[s.index].currentProgress=+i[s.index].currentProgress+ +x[c-1].experiences,i[s.index].completed=+n[s.index].currentProgress>=+n[s.index].missonId.numberOfRequirements,i}),T=[...T,s.misson];break;case"days":case"lessons":await C.patch(`user_missons/update?missonId=${s.misson.missonId._id}`,{currentProgress:1,status:+n[s.index].currentProgress+1>=+n[s.index].missonId.numberOfRequirements}),f(S=>{const i=[...S];return i[s.index].currentProgress=+i[s.index].currentProgress+1,i[s.index].completed=+n[s.index].currentProgress>=+n[s.index].missonId.numberOfRequirements,i}),T=[...T,s.misson];break;default:}});await Promise.all(v),p(!1),L(s=>[...s,...T]),A(!0),d(!0),m(s=>{const o=[...s],I=o.findIndex(y=>y.courseId._id.toString()===t.toString()),S=o[I].sections.findIndex(y=>y.sectionId.toString()===P.toString());o[I].sections[S].totalMilestoneDone=+o[I].sections[S].totalMilestoneDone+1;const i=o[I].sections[S].milestones.findIndex(y=>y.milestoneId.toString()===R.toString());return o[I].sections[S].milestones[i].currentLesson=c+1,o[I].sections[S].milestones[i].status=2,o}),E(0);return}else{p(!0),await C.patch("users/update_asset",{experiences:+x[c-1].experiences,gems:+x[c-1].gems,turns:5,dayStreak:Math.random()}),_(s=>{const o={...s};return o.experiences=+o.experiences+ +x[c-1].experiences,o.gems=+o.gems+ +x[c-1].gems,o.hearts=+o.hearts+5,o}),await C.patch("learning_process/update_milestone",{courseId:t,sectionId:P,milestoneId:R,currentLesson:b,totalLessonDone:b});const v=B.map(async s=>{var o,I;switch((I=(o=s==null?void 0:s.misson)==null?void 0:o.missonId)==null?void 0:I.type){case"gems":await C.patch(`user_missons/update?missonId=${s.misson.missonId._id}`,{currentProgress:+x[c-1].gems,status:+n[s.index].currentProgress+ +x[c-1].gems>=+s.misson.missonId.numberOfRequirements}),f(S=>{const i=[...S];return i[s.index].currentProgress=+i[s.index].currentProgress+ +x[c-1].gems,i[s.index].completed=+n[s.index].currentProgress>=+s.misson.missonId.numberOfRequirements,i}),T=[...T,s.misson];break;case"experiences":await C.patch(`user_missons/update?missonId=${s.misson.missonId._id}`,{currentProgress:+x[c-1].experiences,status:+n[s.index].currentProgress+ +x[c-1].experiences>=+s.misson.missonId.numberOfRequirements}),f(S=>{const i=[...S];return i[s.index].currentProgress=+i[s.index].currentProgress+ +x[c-1].experiences,i[s.index].completed=+n[s.index].currentProgress>=+s.misson.missonId.numberOfRequirements,i}),T=[...T,s.misson];break;case"days":case"lessons":await C.patch(`user_missons/update?missonId=${s.misson.missonId._id}`,{currentProgress:1,status:+n[s.index].currentProgress+1>=+s.misson.missonId.numberOfRequirements}),f(S=>{const i=[...S];return i[s.index].currentProgress=+i[s.index].currentProgress+1,i[s.index].completed=+n[s.index].currentProgress>=+s.misson.missonId.numberOfRequirements,i}),T=[...T,s.misson];break;default:}});await Promise.all(v),p(!1),L(s=>[...s,...T]),A(!0),d(!0),F(c+1),m(s=>{const o=[...s],I=o.findIndex(y=>y.courseId._id.toString()===t.toString()),S=o[I].sections.findIndex(y=>y.sectionId.toString()===P.toString()),i=o[I].sections[S].milestones.findIndex(y=>y.milestoneId.toString()===R.toString());return o[I].sections[S].milestones[i].currentLesson=c+1,o}),E(0)}}catch{E(0)}E(0)}},[N]),de=()=>{M(!1)};return l.useEffect(()=>{j.current.style.width=N/(g==null?void 0:g.length)*100+"%"},[g,N]),l.useEffect(()=>{(async()=>{if(!(O.findIndex(o=>o.lesson._id.toString()===u.toString())>-1))try{await C.patch("summary_lesson/add_lesson",{lessonId:u}),D(o=>{const I=[...o];return I.push({lesson:{_id:u},wrongQuestions:[]}),I})}catch{}})()},[u]),e.jsxs(e.Fragment,{children:[U&&e.jsx(ue,{lessons:x,currentLesson:b,setIsCongratulation:A,setIsLesson:M}),e.jsx(he,{listMisson:G,setListMisson:L,isShowInfoMisson:r,setIsShowInfoMisson:d}),e.jsxs("div",{className:"relative h-screen w-full py-6",children:[e.jsxs("ul",{className:"mx-auto flex w-[90%] items-center justify-center md:w-[75%]",children:[e.jsx("li",{children:e.jsx("i",{onClick:de,className:"fa-solid fa-arrow-left cursor-pointer text-2xl md:text-3xl"})}),e.jsx("li",{className:"mx-3 h-4 w-full rounded-md bg-[#e5e5e5]",children:e.jsx("div",{ref:j,className:"ml-[2px] mt-[2px] h-[0.8rem] w-[0%] rounded-md bg-red-600 transition ease-linear"})}),e.jsxs("li",{className:"flex items-center justify-center",children:[e.jsx("img",{src:"/images/logo/heart.webp",className:"h-7 w-7"}),e.jsx("p",{className:"lazyload ml-1 flex items-center justify-center font-noto text-2xl font-medium text-red-600 md:text-3xl",children:a!=null&&a.hearts?a==null?void 0:a.hearts:0})]})]}),g&&((X=(V=g[N])==null?void 0:V.question)==null?void 0:X.type)==="choose"?e.jsx(ie,{question:(Y=g[N])==null?void 0:Y.question,lessonId:u,handleNextQuestion:K,setQuestionsCorrect:$}):g&&((q=(Z=g[N])==null?void 0:Z.question)==null?void 0:q.type)==="match"?e.jsx(me,{question:(ee=g[N])==null?void 0:ee.question,lessonId:u,handleNextQuestion:K,setQuestionsCorrect:$}):g&&((se=(te=g[N])==null?void 0:te.question)==null?void 0:se.type)==="fill"?e.jsx(xe,{question:(re=g[N])==null?void 0:re.question,lessonId:u,handleNextQuestion:K,setQuestionsCorrect:$}):g&&((le=(ne=g[N])==null?void 0:ne.question)==null?void 0:le.type)==="rearrange"?e.jsx(fe,{question:(ae=g[N])==null?void 0:ae.question,lessonId:u,handleNextQuestion:K,setQuestionsCorrect:$}):""]})]})};export{be as default};
