import{r as s,j as e,i as S,U as P}from"./index-BZcJT81W.js";import{a as L,N as M,G as E,V as q,M as T}from"./MainLayout-CeJSiQZ4.js";import{u as z}from"./index.esm-5b3-k6AR.js";const U=({setIsEditPassword:r})=>{const[c,w]=s.useState(),[n,j]=s.useState(!1),[a,f]=s.useState(!1),{register:u,handleSubmit:m,setFocus:x,watch:i,formState:{errors:o,isSubmitting:v}}=z();s.useEffect(()=>{x("password")},[x]);const g=i("newPassword"),d=async t=>{const{password:h,newPassword:p}=t;await S.patch("users/change_password",{password:h,newPassword:p}).then(l=>{var b;w((b=l==null?void 0:l.data)==null?void 0:b.message),setTimeout(()=>r(!1),3e3)}).catch(l=>{w(()=>{var b;return(b=l==null?void 0:l.response)!=null&&b.data&&Array.isArray(l.response.data)?l.response.data.map(C=>C.message).join(`
`):l.response.data.message})})};return e.jsxs("div",{className:"fixed left-1/3 top-1/3 z-20 mx-auto mt-10 w-[95%] sm:w-96 -translate-x-1/3 -translate-y-1/2 transform rounded-lg bg-white p-6 font-noto shadow-md sm:left-1/2 sm:-translate-x-1/2 md:left-[66%] xl:left-[57%]",children:[e.jsx("i",{className:"fa-solid fa-xmark-large absolute right-3 top-3 cursor-pointer",onClick:()=>r(!1),children:"X"}),e.jsx("h2",{className:"mb-6 text-center text-2xl font-semibold",children:"Thay đổi mật khẩu"}),e.jsxs("form",{onSubmit:m(d),className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{...u("password",{required:"Nhập mật khẩu của bạn",validate:t=>t.match(/^[A-Za-z0-9!@#$%^&*(),.?":{}|<>_-]+$/)?!0:"Vui lòng nhập mật khẩu của bạn"}),type:n?"text":"password",placeholder:"Mật khẩu",className:"mb-[0.5rem] w-full border border-inherit p-2 pl-3 font-noto outline-none"}),n?e.jsx("i",{className:"fa-solid fa-eye-slash absolute right-3 top-3 cursor-pointer",onClick:()=>j(!n)}):e.jsx("i",{className:"fa-solid fa-eye absolute right-3 top-3 cursor-pointer",onClick:()=>j(!n)}),e.jsx("br",{}),o.password&&e.jsx("p",{className:"mb-2 font-noto text-red-500",children:o.password.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{...u("newPassword",{required:"Nhập mật khẩu mới của bạn",minLength:{value:6,message:"Mật khẩu phải nhiều hơn 6 ký tự"},validate:t=>t.match(/^[A-Za-z0-9!@#$%^&*(),.?":{}|<>_-]+$/)?!0:"Mật khẩu chỉ bao gồm ký tự, chữ và số không bao gồm dấu cách!"}),type:a?"text":"password",placeholder:"Mật khẩu mới",className:"mb-[0.5rem] w-full border border-inherit p-2 pl-3 font-noto outline-none"}),a?e.jsx("i",{className:"fa-solid fa-eye-slash absolute right-3 top-3 cursor-pointer",onClick:()=>f(!a)}):e.jsx("i",{className:"fa-solid fa-eye absolute right-3 top-3 cursor-pointer",onClick:()=>f(!a)}),e.jsx("br",{}),o.newPassword&&e.jsx("p",{className:"mb-2 font-noto text-red-500",children:o.newPassword.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{...u("confirmPassword",{required:"Xác nhận lại mật khẩu mới của bạn",validate:t=>t===g||"Xác nhận mật khẩu không đúng"}),name:"confirmPassword",type:a?"text":"password",placeholder:"Xác nhận mật khẩu mới",className:"mb-[0.5rem] w-full border border-inherit p-2 pl-3 font-noto outline-none"}),a?e.jsx("i",{className:"fa-solid fa-eye-slash absolute right-3 top-3 cursor-pointer",onClick:()=>f(!a)}):e.jsx("i",{className:"fa-solid fa-eye absolute right-3 top-3 cursor-pointer",onClick:()=>f(!a)}),e.jsx("br",{}),o.confirmPassword&&e.jsx("p",{className:"mb-2 font-noto text-red-500",children:o.confirmPassword.message})]}),e.jsx("button",{type:"submit",className:"w-full rounded-md bg-gradient-to-r from-pink-400 to-blue-600 py-2 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500",children:v?"Đang lưu...":"Lưu mật khẩu"}),e.jsx("p",{className:"text-center font-noto text-lg text-red-500",children:c})]})]})},$=({setIsEditProfile:r})=>{const{profile:c,setProfile:w}=s.useContext(P),[n,j]=s.useState(c==null?void 0:c.fullName),[a,f]=s.useState(c==null?void 0:c.sex),[u,m]=s.useState(!1),[x,i]=s.useState(),o=["0","1"],v=async d=>{if(d.preventDefault(),!n){i("Vui lòng nhập tên của bạn");return}if(n.length>30){i("Không nhập tên dài quá 30 ký tự");return}u||(m(!0),await S.patch("users/update_information",{fullName:n,sex:a}).then(t=>{var h;i((h=t==null?void 0:t.data)==null?void 0:h.message),m(!1),w(p=>({...p,fullName:n,sex:a})),setTimeout(()=>r(!1),1e3)}).catch(t=>{var h;m(!1),i((h=t==null?void 0:t.response)==null?void 0:h.message)}))},g=d=>{switch(d){case 0:return"Nữ";case 1:return"Nam";default:return}};return e.jsxs("div",{className:"fixed left-1/3 top-1/3 z-20 mx-auto mt-10 w-[95%] -translate-x-1/3 -translate-y-1/2 transform rounded-lg bg-white p-6 font-noto shadow-md sm:left-1/2 sm:w-96 sm:-translate-x-1/2 md:left-[66%] xl:left-[57%]",children:[e.jsx("i",{className:"fa-solid fa-xmark-large absolute right-3 top-3 cursor-pointer",onClick:()=>r(!1),children:"X"}),e.jsx("h2",{className:"mb-6 text-center text-2xl font-semibold",children:"Chỉnh sửa thông tin"}),e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",htmlFor:"currentPassword",children:"Họ và tên"}),e.jsx("input",{id:"fullName",value:n,onChange:d=>j(d.target.value),className:"mt-1 w-full rounded-md border border-gray-300 p-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Giới tính"}),e.jsx(L,{value:g(a),onChange:f,children:e.jsxs("div",{className:"relative mt-2",children:[e.jsx(M,{className:"relative w-full cursor-default rounded-md bg-white py-2 pl-3 pr-10 text-left text-gray-900 shadow-md",children:g(a)}),e.jsx(E,{transition:!0,className:"absolute z-10 mt-1 max-h-56 w-auto overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black/5 focus:outline-none data-[closed]:data-[leave]:opacity-0 data-[leave]:transition data-[leave]:duration-100 data-[leave]:ease-in sm:text-sm",children:o&&o.map((d,t)=>e.jsx(q,{value:t,className:"group relative w-32 cursor-default select-none py-2 pl-1 pr-1 text-gray-900 data-[focus]:bg-indigo-600 data-[focus]:text-white",children:g(t)},t))})]})})]}),e.jsx("button",{onClick:v,className:"w-full rounded-md bg-gradient-to-r from-pink-400 to-blue-600 py-2 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500",children:u?"Đang lưu...":"Lưu thông tin"}),e.jsx("p",{className:"text-center font-noto text-lg text-red-500",children:x})]})]})},X=()=>{const{profile:r,setProfile:c}=s.useContext(P),[w,n]=s.useState(!1),[j,a]=s.useState(!1),[f,u]=s.useState("Lưu ảnh"),[m,x]=s.useState(!1),[i,o]=s.useState(!1),[v,g]=s.useState(!1),[d,t]=s.useState(!1),[h,p]=s.useState(0),l=y=>{if(y.target.files.length>0){const k=y.target.files[0];let N=URL.createObjectURL(k);a(k),x(N)}},b=async y=>{if(h===1)return;if(p(1),!m){p(0);return}y.preventDefault();const k=new FormData;k.append("file",j),u("Đang lưu"),await S.patch("users/avatar",k,{headers:{"Content-Type":"multipart/form-data"}}).then(N=>{c(A=>({...A,avatar:N.data.avatar})),u("Lưu ảnh"),x(!1),t(N.data.message),setTimeout(()=>t(""),1e3),p(0),o(!1)}).catch(N=>{p(0),u("Lưu ảnh"),t(N.response.data[0].message)})},C=()=>{x(!1),o(!1)};return e.jsxs(T,{children:[!!r&&e.jsxs("div",{className:"absolute mt-[5rem] pb-[5rem] md:left-[5.5rem] md:w-[75vw] lg:left-[17rem] lg:w-[69vw] w-full rounded-lg bg-white shadow-lg",children:[e.jsxs("div",{className:"relative w-full flex justify-center",children:[e.jsx("img",{src:m||(r.avatar?r.avatar:"/images/logo/person-default.png"),alt:"User Avatar",className:"h-96 md:h-[60vh] w-full sm:w-3/4 lg:w-[60%] xl:w-[45%] rounded-lg object-cover lazyload"}),i?e.jsxs("ul",{className:"flex absolute bottom-1 right-4 ",children:[e.jsx("button",{onClick:C,className:"flex transform rounded-full bg-gradient-to-r from-pink-400 to-blue-600 px-4 py-2 text-white shadow-lg transition-all duration-300 hover:scale-105 hover:bg-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-300 active:scale-95",children:e.jsx("span",{className:"font-noto text-sm",children:"Dừng thay đổi"})}),e.jsx("button",{onClick:b,className:"transform rounded-full bg-gradient-to-r from-pink-400 to-blue-600 px-4 py-2 text-white shadow-lg transition-all duration-300 hover:scale-105 hover:bg-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-300 active:scale-95",children:e.jsxs("span",{className:"flex items-center justify-center space-x-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${i?"rotate-180":"rotate-0"} transition-transform duration-300`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})}),e.jsx("span",{className:"font-noto text-sm",children:f})]})})]}):e.jsx("button",{onClick:()=>o(!0),className:"absolute bottom-1 right-4 transform rounded-full bg-gradient-to-r from-pink-400 to-blue-600 px-4 py-2 text-white shadow-lg transition-all duration-300 hover:scale-105 hover:bg-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-300 active:scale-95",children:e.jsxs("span",{className:"flex items-center justify-center space-x-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${i?"rotate-180":"rotate-0"} transition-transform duration-300`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})}),e.jsx("span",{className:"font-noto text-sm",children:"Chỉnh sửa ảnh"})]})})]}),i&&e.jsx("div",{className:"flex justify-center",children:e.jsx("input",{type:"file",accept:"image/*",onChange:l,className:"mt-2 rounded-lg border p-2"})}),e.jsx("p",{className:"w-full text-center text-2xl text-red-600 px-2 mt-1 text-wrap",children:d}),e.jsxs("div",{className:"ml-3 mt-3 md:ml-0 md:text-center",children:[e.jsxs("h2",{className:"font-noto text-xl lg:text-2xl",children:["Tên: ",r.fullName]}),e.jsxs("p",{className:"mt-2 font-noto text-xl lg:text-2xl",children:["Email: ",r.email]}),e.jsxs("p",{className:"mt-2 font-noto text-xl lg:text-2xl",children:["Giới tính: ",r.sex===0?"Nữ":"Nam"]})]}),e.jsxs("div",{className:"mt-6 mx-2 flex flex-col justify-center md:flex-row",children:[e.jsx("div",{onClick:()=>n(!w),className:"transform cursor-pointer rounded-lg bg-gradient-to-r from-pink-400 to-blue-600 px-6 py-3 font-noto text-lg text-white shadow-lg transition-transform duration-300  hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 active:scale-95",children:"Chỉnh sửa thông tin"}),e.jsx("div",{onClick:()=>g(!v),className:"mt-2 transform cursor-pointer rounded-lg bg-gradient-to-r from-pink-400 to-blue-600 px-6 py-3 font-noto text-lg text-white shadow-lg transition-transform duration-300  hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 active:scale-95 md:ml-2 md:mt-0",children:"Thay đổi mật khẩu"})]})]}),v&&e.jsx(U,{setIsEditPassword:g}),w&&e.jsx($,{setIsEditProfile:n})]})};export{X as default};
